<!DOCTYPE html>
<html>
<head>
	<title>Goblin Game</title>

</head>
<body>
	<script type="text/javascript">
	//Create the canvas with JS
		var canvas = document.createElement('canvas');
		var ctx = canvas.getContext('2d');
		canvas.width = 512;
		canvas.height = 480;

		document.body.appendChild(canvas);

		//make a background image!
		var bgImage = new Image();
		var bgReady = false;
		bgImage.onload = function(){
			bgReady = true;
		}

		bgImage.src = "background.png";

		//Make the hero
		var hero = new Image();
		hero.src = "hero.png";
		var heroObj = {
			speed: 100, //movement in pixels per second
			x: 240,
			y: 224
		};

		var goblin = new Image();
		goblin.src = "goblin.png";
		var goblinObj = {}

		// Handler for keyboard Actions
		var keysDown = {};

		addEventListener('keydown', function(e){
			keysDown[e.keyCode] = true;
		});

		addEventListener('keyup', function(e){
			delete keysDown[e.keyCode];
		});
		console.log(hero)
		// Update Function
		// This will update the canvas images that are moving
		// It will change the hero's location and eventually , check to see if he touched monster
		var update = function(modifier){
			if(38 in keysDown){
				//User pressed up
				heroObj.y -= heroObj.speed * modifier;
			}
			if(40 in keysDown){
				heroObj.y += heroObj.speed * modifier;
			}
			if(37 in keysDown){
				heroObj.x -= heroObj.speed * modifier;
			}
			if(39 in keysDown){
				heroObj.x += heroObj.speed * modifier;
			}
			if(heroObj.x < 0 + 30){
				heroObj.x = 30;
			}else if(heroObj.x > canvas.width - 30 - hero.width){
				heroObj.x = canvas.width - hero.width - 30;
			}
			if(heroObj.y < 0 + 28){
				heroObj.y = 28;
			}else if(heroObj.y > canvas.height - 32 - hero.height){
				heroObj.y = canvas.height - hero.height - 32;
			}

		}
		//Draw our stuff
		var render = function(){
			if(bgReady){
				ctx.drawImage(bgImage, 0, 0);
			}
			ctx.drawImage(goblin, 100, 100);
			ctx.drawImage(hero, heroObj.x, heroObj.y)
		}

		

		var main = function(){

			var now = Date.now();
			var delta = now - then;
			update(delta / 1000);
			render();
			then = now;
			requestAnimationFrame(main)
		}
		var then = Date.now();
		main();
	</script>
</body>
</html>